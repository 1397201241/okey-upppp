<% if (item.password) { %>
    <div id="password-protect">
        <p>这篇文章受密码保护，请输入密码查看内容：</p>
        <input type="password" id="password-input" placeholder="请输入密码">
        <button id="password-submit">提交</button>
        <p id="password-error" style="color: red; display: none;">密码错误，请重试！</p>
    </div>
    <div id="post-content" style="display: none;">
        <div class="cube-article">
            <%- partial('post/title', {item: item}) %>
            <% if (!isPage) { %>
                <div class="cube-article-header">
                    <div class="cube-article-date">
                        <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                        <!-- moment.js对象 -->
                        <%= item.date.format('YYYY-MM-DD') %>
                    </div>
                    <%- partial('post/tag', {item: item}) %>
                </div>
            <% } else { %>
                <div class="cube-article-header">
                    <div class="cube-article-date page">
                        <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                        <!-- moment.js对象 -->
                        <%= item.date.format('YYYY-MM-DD') %>
                    </div>
                </div>
            <% } %>
            <div class="cube-article-content cube-markdown">
                <%- partial('post/gallery', {item: item}) %>
                <%- item.content %>
            </div>
        </div>
    </div>
<% } else { %>
    <div id="post-content">
        <div class="cube-article">
            <%- partial('post/title', {item: item}) %>
            <% if (!isPage) { %>
                <div class="cube-article-header">
                    <div class="cube-article-date">
                        <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                        <!-- moment.js对象 -->
                        <%= item.date.format('YYYY-MM-DD') %>
                    </div>
                    <%- partial('post/tag', {item: item}) %>
                </div>
            <% } else { %>
                <div class="cube-article-header">
                    <div class="cube-article-date page">
                        <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                        <!-- moment.js对象 -->
                        <%= item.date.format('YYYY-MM-DD') %>
                    </div>
                </div>
            <% } %>
            <div class="cube-article-content cube-markdown">
                <%- partial('post/gallery', {item: item}) %>
                <%- item.content %>
            </div>
        </div>
    </div>

<% } %>


<% if (!isPage) { %>
    <div class="cube-article-nav">
        <ul>
            <% if (item.prev) { %>
                <li class="prev">
                    <a href="<%= url_for(item.prev.path) %>">
                        <i class="cube-icon cube-prev" aria-hidden="true"></i>
                        <%= item.prev.title %>
                    </a>
                </li>
            <% } %>
            <% if (item.next) { %>
                <li class="next">
                    <a href="<%= url_for(item.next.path) %>">
                        <%= item.next.title %>
                        <i class="cube-icon cube-next" aria-hidden="true"></i>
                    </a>
                </li>
            <% } %>
        </ul>
    </div>
<% } %>
<% if (!isPage || (isPage && item.comment)) { %>
    <%- partial('comment/entry', {item: item}) %>
<% } %>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    const submitBtn = document.getElementById("password-submit");
    const postContent = document.getElementById("post-content");
    const passwordInput = document.getElementById("password-input");
    const errorText = document.getElementById("password-error");

    if (submitBtn) {
      submitBtn.addEventListener("click", function() {
        const inputPassword = passwordInput.value;
        const correctPassword = "<%= item.password %>"; // 从模板获取文章密码

        if (inputPassword === correctPassword) {
          postContent.style.display = "block";  // 显示文章内容
          document.getElementById("password-protect").style.display = "none"; // 隐藏密码输入框
        } else {
          errorText.style.display = "block";  // 显示错误提示
        }
      });
    }
  });
</script>